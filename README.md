SmartUPS:充电宝当成防断电保护电源
本项目有几个高中生开发（@potatotyy,@wangzhidong2,@xjuny,@hajiyu），如有缺点欢迎邮箱联系，联系方式见文末
对了，提供代码自己用arduino,本项目用的是WeMosD1,要什么硬件自己看图

项目简介
 
SmartUPS 可以将你的充电宝当成智能防断电保护电源，核心解决网络设备（路由器、网关等）短时间断电的痛点。方案以支持PD协议的快充充电宝为储能单元，结合Wemos D1单片机构建智能控制系统，实现市电与应急供电的毫秒级无缝切换，成本仅为传统UPS的39%，兼具高稳定性、轻量化与智能化优势。
 
核心特性
 
- 低成本高性价比：核心硬件成本约50元，兼容家庭现有PD快充充电宝，无需额外购置高价UPS设备
- 毫秒级无间断切换：供电切换延迟＜100ms，配合电容续流设计，路由器无重启、WiFi信号不中断
- 稳定供电输出：12V档位输出纹波35mV~70mV，远低于国标≤200mV限值，媲美原装适配器
- 长续航能力：10000mAh充电宝可供电7小时以上，15000mAh型号可达13小时，满足应急需求
- 轻量化智能监控：自带WiFi热点与web管理界面，无需额外APP，实时查看供电状态、配置网络
 
硬件清单
 
组件 规格要求 
快充充电宝 支持PD协议12V输出（推荐10000mAh及以上） 
单片机 Wemos D1（WiFi功能必备） 
核心配件 PD诱骗器（支持12V档位锁定）、继电器模块 
电子元件 2kΩ电阻、10kΩ电阻、肖特基二极管、电容器 
连接配件 USB-C公头、DC公母头（1对）、杜邦线、面包板 
 
快速上手
 
1. 电路搭建
 
（1）分压检测电路（市电状态检测）
 
- 2kΩ电阻与10kΩ电阻串联接入面包板
- 10kΩ端接市电适配器12V正极，另一端接GND
- 串联节点引出杜邦线连接Wemos D1的A0引脚（实现12V→2V分压适配）
 
（2）继电器控制电路
 
- 继电器VCC接Wemos D1的5V引脚，GND与开发板共地
- 继电器IN引脚连接Wemos D1的D6（GPIO12）引脚
 
（3）供电回路连接
 
- 市电支路：DC母座正极接面包板，负极连路由器GND，串联肖特基二极管
- 充电宝支路：USB-C公头接PD充电宝，经PD诱骗器（设12V档）连接继电器公共端，常开端接肖特基二极管负极
- 输出端：DC公头正极接二极管组，负极共地，串联电容器防供电空白
 
2. 系统配置
 
1. 设备上电后，搜索WiFi热点（SSID：smartUPS，密码：12345678）
2. 连接热点后访问后台地址：192.168.4.1
3. 在web界面查看当前供电状态，通过「网络配置」选项连接家庭WiFi
4. 连接成功后热点自动关闭，可通过路由器管理后台查找ESP开头设备的IP，访问新管理地址
 
性能参数
 
测试项目 指标数据 
供电电压 12V（PD协议标准档位） 
输出纹波 35mV~70mV（低于国标限值） 
切换延迟 ＜100ms 
10000mAh续航 7小时13分钟（中兴AX3000） 
15000mAh续航 13小时（中兴AX3000） 
支持负载功率 ≤36W（PD协议12V×3A） 
 
适用场景
 
家庭路由器、网关等网络设备应急供电
更多功能由你开发
 
未来规划
 
- 新增网页端电压调节功能，支持自定义PD诱骗器输出电压
- 接入智能物联网平台，实现远程控制与状态监控
 
开源声明
 
本项目基于MIT开源协议，欢迎开发者fork、star并参与迭代优化。如需商用，请注明项目来源及作者信息。
 
 
项目地址：[https://github.com/wangzhidong2/PD-smartUPS
作者：wangzhidong2
反馈建议：wzd123789@hotmail.com,备注smartUPS建议反馈
项目起源与探索历程
 
2025年12月4日
wangzhidong2
 
 
讲个故事 
缘起：化学实验的意外延伸
 今年中考结束后，我原本计划设计一个化学实验项目——电解水实验的改进与再探。
 最初的目标是用新型电源替代传统电源，因为传统电源体积大、笨重且输出不稳定。当时我的化学老师建议，可以试试用手机快充头来做实验，他提到现在手机的快充协议可以输出高压，但是我折腾了半天仍然输出5V电压（后来知道没有协议，A口只能输出五伏）
 由于留给实验设计的时间只有两天，这个想法暂时被搁置了。项目提交后，我在网上查找论文时，偶然发现了讲解PD协议的内容。与何老师交流后，他鼓励我继续深入研究这个方向。
 契机：路由器变砖引发的技术探索
 巧合的是，我的路由器因升级固件变砖了，这促使我深入了解。2022年USB4 80Gbps发布后，我便已经开始type-C接口引脚定义知识的涉猎。
 在查阅论文时，我了解到PD协议通过CC1与CC2引脚进行通信，这让我联想到普通充电器在无手机或电脑连接时无电压输出的现象。于是，我去USB-IF官网查阅了PD协议的完整规格：
 -基础输出：5V 2A、9V 3A、12V 3A、15V 3A、20V 5A
- PPS模式：5-20V 5A
- 通信核心：CC引脚
 其中12V输出正好可以为路由器供电，这让我萌生了用快充头替代路由器原装电源的想法。
 实践：从开源工具到智能电源
 后来我在CSDN上了解到PD诱骗器可以让充电器输出高压，便在PDD上购买了一个20元的诱骗器，同时搭配了炬为UC96P多功能检测仪进行测试。测试中我发现CC1、CC2引脚存在电压，这说明诱骗器正在正常工作。
 之后我在GitHub上搜寻了一周，终于找到了开源项目 PDTricker。它提供了完整的资料，包括固件、BOM表、电路，并且采用非商用授权协议。我将这些资料分享给化学老师后，他建议我整合这些内容，进一步开发一个物联网化的智能化多功能电源。
 由于我的初衷是让更多人受益于这个项目，所以我选择直接将它开源。
 
 
 致谢
 
特别感谢 PDTricker 项目的作者 wuxx，你的开源工作为我的研究提供了坚实的基础。
